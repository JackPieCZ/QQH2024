from io import BytesIO
import torch
import base64
from torch import nn
# Load the model or state_dict
model_or_state_dict = torch.load(
    "D:/_FEL/QQH2024/testing/kuba/best_model_epoch.pth")

# If it's an OrderedDict (state_dict), save it directly
if isinstance(model_or_state_dict, dict):
    torch.save(model_or_state_dict, 'D:/_FEL/QQH2024/testing/kuba/best_model_epoch.pt',
               _use_new_zipfile_serialization=False)
else:
    # If it's a full model, save its state_dict
    torch.save(model_or_state_dict.state_dict(
    ), 'D:/_FEL/QQH2024/testing/kuba/best_model_epoch.pt', _use_new_zipfile_serialization=False)

# Encode the saved weights to Base64
with open('D:/_FEL/QQH2024/testing/kuba/best_model_epoch.pt', 'rb') as f:
    encoded = base64.b64encode(f.read()).decode('utf-8')

print(encoded)  # Copy this output into your .py file

# fmt: off
base64_str = "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"
# fmt: on
print(encoded == base64_str)
# Decode the Base64 string
decoded = base64.b64decode(encoded)

# Create a buffer from the decoded bytes
buffer = BytesIO(decoded)

# Load the state_dict from the buffer
state_dict = torch.load(buffer, weights_only=True)


class ResidualBlock(nn.Module):
    def __init__(self, input_size, output_size, dropout=0.4):
        super(ResidualBlock, self).__init__()
        self.fc = nn.Sequential(
            nn.Linear(input_size, output_size),
            nn.LeakyReLU(negative_slope=0.01),  # Replace ReLU with LeakyReLU
            nn.BatchNorm1d(output_size),
            nn.Dropout(dropout)
        )
        # Shortcut for residual connection
        self.shortcut = nn.Linear(input_size, output_size)

    def forward(self, x):
        return self.fc(x) + self.shortcut(x)


class Net(nn.Module):
    def __init__(self, input_size):
        super(Net, self).__init__()
        self.block1 = ResidualBlock(input_size, 512, dropout=0.4)
        self.block2 = ResidualBlock(512, 256, dropout=0.4)
        self.block3 = ResidualBlock(256, 128, dropout=0.3)
        self.block4 = ResidualBlock(128, 64, dropout=0.3)  # New block
        self.fc = nn.Sequential(
            nn.Linear(64, 32),
            nn.SiLU(),  # Swish activation
            nn.BatchNorm1d(32),
            nn.Linear(32, 1),
            nn.Sigmoid()
        )

    def forward(self, x):
        x = x.view(1, -1)
        x = self.block1(x)
        x = self.block2(x)
        x = self.block3(x)
        x = self.block4(x)
        return self.fc(x)


# Initialize your model
model = Net(393)

# Load the state_dict into the model
model.load_state_dict(state_dict)

# The model is now ready for use
model.eval()  # Set to evaluation mode if you are using it for inference
